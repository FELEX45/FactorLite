# Концепция игры (Megabonk-like) — 2D Android, libGDX (Kotlin)

### Коротко (1 абзац)
Аркадный survivor-like таймкиллер: **игрок только двигается** (floating joystick), а персонаж **сам атакует ближайшего врага**. В забеге игрок собирает опыт, получает **Level Up** и выбирает улучшения **только оружия и пассивок**. В мире появляются **сундуки**, которые открываются за **валюту, добытую в забеге**, либо падают с элиток/боссов. Забег идёт **до смерти** или по режиму **“на время → босс → следующий уровень”**.

---

## Основные принципы “как Megabonk”

### 1) Персонаж = билд-ось
У каждого персонажа:
- **Врожденное оружие** (стиль атаки/паттерн).
- **Врожденная способность**, которая **скейлится от уровня** (формат “получай X% за уровень”).

### 2) Оружие = поведение, а не “+цифры”
Каждое оружие меняет **паттерн атаки** (меч режет цепочкой, лук — пробивает, чёрная дыра — контроль и т.д.), а апгрейды усиливают паттерн (больше целей/радиус/пробивание/кд).

### 3) Два независимых канала усиления
- **Level Up**: только улучшения оружия/пассивок (никаких хилов/золота/ресурсов).
- **Сундуки/дроп**: предметы/перки/редкости, которые не дублируют уровень, а добавляют “особые правила”.

### 4) Ограничение слотов (сейчас) — фокус и баланс
В текущей версии:
- **2 оружия**
- **2 пассивки**
С расширением в будущих апдейтах (3+ слота) без переписывания систем.

---

## Режимы забега

### A) Бесконечный (до смерти)
- Цель: **рекорд** (время/очки/уровень/убийства).
- Сложность растёт волнами/таймером/уровнем игрока.

### B) Уровневый (на время → босс → следующий уровень)
- На уровне есть таймер/задача “найти портал/босса”.
- Босс убит → следующий уровень (новая арена/набор врагов/шанс сундуков).

---

## Управление (Android)

### Floating joystick (джойстик в месте тапа)
- При касании в левой/любой части экрана появляется “основание” и “ручка”.
- Вектор от основания к текущей позиции пальца = направление.
- Отпускание пальца = движение прекращается.

Рекомендуемые ощущения:
- Мёртвая зона: ~6–10 dp.
- Нормализация: радиус джойстика фиксированный; дальше — clamp.

---

## Боевая модель

### Авто-таргетинг (обязательно “как надо”)
- Каждые N миллисекунд (например, 100–150мс) выбираем **ближайшего живого врага** в радиусе R.
- Чтобы не “дёргалось”, используем **фиксацию цели**:
  - текущая цель удерживается, пока жива и в радиусе R * 1.1
  - переходим на другую цель только если она ближе на ~20% или текущая умерла/ушла далеко

### Автоатака
- Для каждого оружия есть собственный **кулдаун** (или скорострельность).
- Если цель есть и кулдаун истёк — выполняем атаку.

---

## Система слотов (текущая версия)

### Слоты
- **Weapon Slot A**: врождённое оружие персонажа (всегда занято).
- **Weapon Slot B**: дополнительное оружие (выбирается на Level Up).
- **Passive Slot A**: пассивка (выбирается на Level Up или стартовая, если решишь так сделать).
- **Passive Slot B**: пассивка (Level Up).

### Поведение Level Up с учётом лимита 2+2
Чтобы игрок не “ломал” билд случайной заменой:
- Если слот свободен → в пуле могут быть **новые** предметы этого типа.
- Если слот занят → в пуле чаще должны быть **апгрейды** уже имеющегося (и иногда “заменить X на Y” как отдельная карточка).

Рекомендация по карточкам:
- На Level Up показываем **3 карточки**.
- Минимум 1 карточка всегда релевантна текущим слотам (апгрейд существующего).

---

## Level Up (выбор улучшений)

### Что именно предлагается
Только:
- **Оружие** (взять новое / улучшить текущее / заменить)
- **Пассивки** (взять новую / улучшить текущую / заменить)

### Типы апгрейдов оружия (универсальный набор)
- **+урон**
- **-кулдаун / +скорость атаки**
- **+кол-во снарядов/ударов**
- **+пробивание / +цепь целей**
- **+рикошет**
- **+радиус/дальность/скорость снаряда**
- **эффект попадания** (замедление/яд/поджог/оглушение) — реже

### Пассивки (то, что в Megabonk называется “фолианты”)
Ты хочешь заменить “фолианты” на другой тематический слой — ок:
- Вариант “похоже по UX”: **Плащи** (пассивки) + **Шляпы** (косметика/мета)
- Вариант “ещё проще”: **Талисманы/Руны** (пассивки) + шляпы/плащи косметика

Базовый набор пассивок (пример, 12–16 штук для релиза):
- Урон
- Скорость атаки
- Скорость передвижения
- Броня/снижение урона
- Шанс крита
- Крит-урон
- Шанс крита (как отдельная пассивка/прибавка к уже имеющемуся), влияет только на крит
- Магнит подбора (радиус притяжения лута)
- Лайфстил/хил по попаданию (редко)
- Макс HP (если решишь вводить как пассивку)
- Шанс блока/уклонения (как отдельная “пассивка танка”)
- Реген (если нужен, лучше маленький и редкий)

---

## Экономика забега: валюта и сундуки

### Валюта забега
- Падает с врагов/ивентов.
- Тратится только в этом забеге на:
  - сундуки
  - (опционально) святилища/алтарь/магазин на карте

### Сундуки
Варианты получения:
- Спавн на карте (визуально заметные точки).
- Дроп с элиток/боссов (как награда).

Способы открытия:
- За валюта забега (основной).
- Бесплатно (как “боссовый”/элитный сундук).

Содержимое:
- 1–3 награды: предметы/перки/ресурсы
- Есть **редкости** (обычная/редкая/эпик/легендарная)

---

## Предметы (лут из сундуков/боссов)

### Что такое “предмет” в этой концепции
Это не пассивка из Level Up, а **особое правило**, которое добавляет уникальность забега:
- “При получении урона выпускаешь токсичное облако”
- “Шанс получить еду за убийство”
- “Шанс призвать молнию при атаке, молния оглушает”

### Зачем они нужны при системе 2+2
Потому что при малом числе слотов именно предметы:
- дают вариативность билдов,
- компенсируют отсутствие “хилов на Level Up”,
- создают “вау”-моменты (редкий дроп).

---

## Враги и прогрессия сложности (минимум для релиза)

### Минимальный набор врагов (4 типа)
- **Обычный**: медленный, много на экране.
- **Быстрый**: малый HP, заставляет двигаться.
- **Танк**: высокий HP, создаёт давление.
- **Дальник**: стреляет/кастует, ломает “кайтить кругами”.

### Элитка
- Усиленная версия обычного врага (больше HP/урона).
- Гарантирует сундук/редкий дроп.

### Босс
- 2–3 атаки максимум, но читаемые телеграфы.
- Награда: сундук высокой редкости + переход на следующий уровень (в режиме B).

---

## UI/UX (что важно повторить)

### 1) Экран выбора персонажа
Слева: сетка, справа: карточка героя:
- врождённое оружие
- врождённый пассив “X% за уровень”
- скины/визуальные слоты

### 2) Экран “Разблокировки”
Табы (как на скрине):
- Персонажи
- Оружие
- Пассивки (переименовать под твою тему)
- Предметы
- Шляпы/косметика

### 3) HUD в забеге (минимально)
- HP бар
- Уровень (lvl)
- Валюта забега
- Иконки 2 оружий + 2 пассивок (со “стеком/уровнем”)
- Миникарта (по желанию; можно на релиз позже)

---

## План контента для первого релиза (реалистичный)

### Персонажи (4)
Каждый с уникальной связкой:
- стартовое оружие
- пассив “X% за уровень” (крит/броня/скорость/урон или иной понятный стат)

### Оружия (8)
Примерный набор паттернов:
- Меч: цепной удар по N ближайшим
- Лук: пробивание
- Посох: взрывающиеся снаряды
- Револьвер: несколько пуль по разным целям
- Катана: “умный” снаряд/слэш к ближайшему
- Чёрная дыра: контроль + урон в зоне
- Молния: цепная (или как предмет)
- Мины/турель: “поставил — работает”

### Пассивки (12–16)
См. список выше (урон/кд/скорость/броня/крит/магнит/лайфстил…).

### Предметы (20–30)
Простые “правила”, многие на процентах/триггерах.

---

## Баланс (первые “разумные” настройки без перфекционизма)
Важно: это стартовые принципы, цифры докрутишь плейтестом.
- Средний “цикл выстрела” базового оружия: 0.6–1.0 сек.
- Уровни должны приходить быстро в начале (первые 5–7 уровней), затем замедляться.
- Редкости/шансы (если нужны) должны быть отдельной системой (не “удачей”):
  - шанс редкой карточки на Level Up можно привязать к прогрессу/уровню/условиям
  - шанс редкого предмета из сундука — к типу сундука/элитке/боссу/цене

---

## Техническая реализация (libGDX/Kotlin) — каркас систем

### Сущности
- Player
- Enemy
- Projectile (опционально, если не hitscan)
- Loot (валюта/опыт)
- Chest

### Системы
- **InputSystem**: floating joystick → velocity
- **MovementSystem**: позиция/коллизия со стенами
- **TargetingSystem**: ближайшая цель + фиксация
- **WeaponSystem**: кулдауны, спавн снарядов/хитов, апгрейды
- **PassiveSystem**: статы и прок-эффекты
- **SpawnSystem**: волны врагов, элитки, босс
- **ProgressionSystem**: XP → Level Up → выбор 1 из 3
- **ChestSystem**: генерация/открытие/лут
- **UISystem**: HUD + экраны выбора/разблокировок
- **SaveSystem**: прогресс разблокировок, валюта меты, выбранный персонаж

### Ключевые структуры данных (в терминах дизайна)
- WeaponDefinition + WeaponInstance (уровень/кулдаун/моды)
- PassiveDefinition + PassiveInstance
- ItemDefinition (сундуковый “предмет” с редкостью и триггерами)

---

## Расширение “в обновлениях” (3+ слота) без переделок
- В коде сразу хранить `List<WeaponSlot>` и `List<PassiveSlot>`.
- В текущем релизе просто держать `maxWeapons = 2`, `maxPassives = 2`.
- UI рисовать как сетку слотов, лишние — залочены.

---

## Открытые решения (требуют твоего выбора)
1) Что выбрать как замену “фолиантам”:
   - Плащи / Руны / Талисманы / Артефакты
2) Какой режим будет “основным” на релизе:
   - Бесконечный (проще) или уровневый с боссом (чуть сложнее, но “сильнее” по ощущению прогресса)
3) Введение лечения:
   - Так как Level Up хила не даёт, хил лучше оставить только через предметы/еду/сундуки/лайфстил.

